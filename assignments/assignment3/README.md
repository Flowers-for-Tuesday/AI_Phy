# Assignment 3

## 学生信息
- 姓名：徐鸣正
- 学号：2400011328

## 实现思路
借助作业提供的PINN框架，使用神经网络拟合三维电势分布。
经过多次尝试后最终选择以下参数

隐藏层数：4
隐藏层节点数：256
训练轮数：50000
初始学习率：2*1e-5
优化器：Adam
激活函数：tanh
损失函数权重 β：0.1
初始化：Xavier

## 使用方法
python运行train.py文件，训练时每100个epoch会输出一次当前loss数据，
训练结束后会分别将训练损失曲线和训练结果采样图片分别保存在loss文件夹和result文件夹。
其中由于电荷分布关于xy平面对称，故选取了z=0到z=0.9的10个切片体现电势分布。

## 训练成果
见loss文件夹和result文件夹

## 结论分析
实验中主要调整参数为学习率和损失权重β。
由于使用了Adam优化器，在学习率选择1e-3时，训练后期会出现较大的波动，
学习率较小如1e-5则学习速度较慢，训练50000轮依然未收敛。
因此实验最终选择了合适的学习率（2*1e-5）和较多的训练轮数（50000）来得到一个较为稳定且收敛的loss curve。
损失权重则是选择β=0.1使得PDE_loss和BC_loss能在后期保持接近的量级（1e-3左右），
从而平衡二者对损失函数的贡献。

其他参数如神经网络层数、节点数也有少数调整，但差距并不大，这里不作为主要因素进行讨论。
最终选择的是4隐藏层256节点的神经网络，在可接受的训练时间内能给出较好的结果。
激活函数则选择PINN最合适的tanh。

考虑到训练前期和训练后期PDE_loss和BC_loss的量级变化差异较大，
如果采用可变化的损失权重β来平衡二者量级，应该可以加快损失函数的梯度下降，减少学习时间，
但本次实验并未加以尝试，可作为后续的优化方向。